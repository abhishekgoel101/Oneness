
<!DOCTYPE html>
<html>
<body>


<div id="wrapper">
<%include partials/sidebar%>

<div id="page-content-wrapper" style="padding:0;margin-top:60px"> <!--Margin Top is new-->
         <div class="container-fluid page-content-div" style="padding:0">
            <div class="row">
               <div class="col-lg-12 scoll-possible" style="padding:0">



<div class="container">
  <center>
   
  </center>
    <div class="col-sm-3">
    </div>
    <div class="col-sm-6" style="background-color:#fff;border:5px solid rgba(0,0,0,0.1);margin-top:40px">
      <br />

      <div class="alert alert-dismissible" style="border:1px solid #E2E5E1" id="alert-div-avilability">
          <center>
            <label id="avilability"></label>
          </center>
      </div>

          <h1>Add User</h1>
          <form action="/admin/adduser" method="post" class="form-horizontal" id="form">
            <div class="col-sm-12">
              <div class="form-group">
                  <input type="email" required="" name="username" class="form-control" id="username" placeholder="Email" autocomplete="off"><br/>
              </div>
              <div class="form-group">
                  <input type="text" required="" name="phone" class="form-control" maxlength="10" id="phone" placeholder="Phone" autocomplete="off"><br/>
              </div>
              <div class="form-group">
                  <input type="text" required="" name="city" class="form-control" placeholder="City"><br/>
              </div>
              <div class="form-group">
                  <input type="password" required="" name="password" class="form-control" placeholder="Password" autocomplete="off"><br/>
              </div>
              <div class="form-group">
                <label>Role:</label><br/>
                <select data-style="btn-info" name="roleoptions" class="form-control">
                    <optgroup label="Select User Role">
                      <option value="user">User</option>
                        <option value="commuity manager">Commuity Manager</option>
                      <option value="admin">Admin</option>
                    </optgroup>
                </select>
              </div>
              <div class="form-group">
                  <input type="submit" value="Add User" class="btn btn-success">
                  <a value="Add User" class="btn btn-danger" href="/admin/profile">Cancel</a>
              </div>
              </div>
          </form>
      </div>
</div>
</div>
</div>
</div>
</div>
</div> <!--Header-->
<script src="/javascripts/Common.js"></script>

<script>
var selector = '.nav li';
$(selector).removeClass('active');
$('#add-user-nav').addClass('active');
</script>

<script>
  var userExist=false;
  function validatePhone(phone){
      var validity = /^(1\s|1|)?((\(\d{3}\))|\d{3})(\-|\s)?(\d{3})(\-|\s)?(\d{4})$/.test(phone);
      return validity;
    }
$(document).ready(function(){
    $("#username").change(function(){
        if($('#username').val().trim())
        {
            var data=$('#username').val().trim().toLowerCase();
              $.ajax({
                  type: 'POST',
                  data: JSON.stringify({username:data}),
                  contentType: 'application/json',
                  url: '/admin/api/ExistenceUser',
                  success: function (response) {
                    console.log(response);
                      if(response)
                      {
                        userExist=true;
                        // $('#alert-div-avilability').removeClass('alert-success').addClass('alert-danger');
                        $('#alert-div-avilability').css('display','block');
                        $('#avilability').css("color", "#8B8B8B");
                        $('#avilability').text("User "+data+" is already exist");
                      }
                      else{
                        userExist=false;
                        // $('#alert-div-avilability').removeClass('alert-danger').addClass('alert-success');
                        $('#alert-div-avilability').css('display','block');
                        $('#avilability').css("color", "#8B8B8B");
                        $('#avilability').text(data+" is Avilable");
                      }
                  },
                  error: function (response) {

                  }
              });
        }
        else{
          $('#alert-div-avilability').css('display','none');
        }
    });
});
$('#form').submit(function () {

  if(userExist)
  {
    $.alert({
        title: 'Inavlid!',
        content: 'User already exist',
    });
    $('#username').val('');
    return false;
  }
  else {
        if(validatePhone($('#phone').val()))
        {
          return true;
        }
        else {
          $.alert({
              title: 'Inavlid! Phone Number',
              content: 'Phone number is not valid',
          });
          $('#phone').val('');
          return false;
        }
  }

});
</script>
  </body>
</html>
